<div class="quiz-control mb-3">
    <form class="mb-2">
        <div class="form-group">
            <input type="text" id="answer" class="form-control" placeholder="정답을 입력하시오.">
        </div>
    </form>

    <div class="buttons mb-3">
        <button type="button" class="btn btn-secondary me-1" id="check">채점</button>
        <div class="toggle-answer d-inline">
            <button type="button" class="btn btn-warning me-1" id="show-answer">정답 보이기</button>
            <button type="button" class="btn btn-warning" id="hide-answer">정답 숨기기</button>
        </div>
    </div>

    <div class="prompts d-none">
        <blockquote class="prompt-tip correct">
            <p>정답입니다</p>
        </blockquote>

        <blockquote class="prompt-warning incorrect">
            <p>오답입니다</p>
        </blockquote>
    </div>

    <script>
        (() => {
            window.addEventListener("load", () => {
                console.log("loading quiz-controller.")
                const quizControl = document.querySelector("div.quiz-control");
                const answerElement = document.querySelectorAll(".quiz-answer");
                const answerInput = quizControl.querySelector("input#answer");
                const checkBtn = quizControl.querySelector("button#check");
                const toggleAnswerBtn = quizControl.querySelector("div.toggle-answer");
                const prompts = quizControl.querySelector("div.prompts");

                if(!("quiz_plugin_answer" in window)) {
                    quizControl.remove();
                    console.error("error loading quiz-controller.");
                    console.error("answer is not set correctly. please set answer in window.quiz_plugin_answer.");
                    return;
                }

                const answer = window.quiz_plugin_answer;

                let isAnswerVisible = false;

                const setAnswerVisible = (visible = true) => {
                    for(const e of answerElement) {
                        if(visible) {
                            e.classList.add("quiz-answer-visible");
                        } else {
                            e.classList.remove("quiz-answer-visible");
                        }
                    }
                };

                const toggleAnswerVisible = () => {
                    isAnswerVisible = !isAnswerVisible;
                    setAnswerVisible(isAnswerVisible);
                };

                toggleAnswerBtn.addEventListener("click", () => {
                    toggleAnswerVisible();
                    if(isAnswerVisible) {
                        toggleAnswerBtn.classList.add("answer-visible");
                    } else {
                        toggleAnswerBtn.classList.remove("answer-visible");
                    }
                });

                checkBtn.addEventListener("click", () => {
                    prompts.classList.remove("d-none");
                    if(answer === answerInput.value) {
                        checkBtn.disabled = true;
                        answerInput.disabled = true;
                        toggleAnswerBtn.classList.add("d-none");
                        prompts.classList.add("correct");
                        setAnswerVisible();
                    }
                });
            });
        })();
    </script>
</div>
<style>
    /* visiblilty of answer */
    .quiz-answer:not(.quiz-answer-visible) {
        display: none;
    }

    /* visiblilty of prompts */
    .prompts.correct .incorrect {
        display: none;
    }

    /* visiblilty of prompts */
    .prompts:not(.correct) .correct {
        display: none;
    }

    /* visiblilty of toggle answer button */
    .toggle-answer.answer-visible #show-answer {
        display: none;
    }

    /* visiblilty of toggle answer button */
    .toggle-answer:not(.answer-visible) #hide-answer {
        display: none;
    }
</style>